# イベントストーミング - Step9: 集約を見つける

## 集約の定義
コマンドを受け取り、イベントを生成する業務の単位（集約）を定義します。

### 1. 施策パッケージ集約

#### 概要
- 複数の関連施策をまとめて管理する単位
- 施策間の依存関係を文書として保持

#### 受け付けるコマンド
- 改善施策を提案する
- 施策を提案する（代理店から）
- 実現可能性の評価を依頼する

#### 生成するイベント
- 改善施策が提案された
- 代理店から施策が提案された
- 実現可能性が評価された
- 費用対効果が算出された

#### 保持する情報
- 施策ID
- 施策概要
- 関連施策リスト
- 依存関係文書
- 提案元情報

### 2. 承認管理集約

#### 概要
- 施策単位での承認プロセスを管理
- 部門内での承認フローを制御

#### 受け付けるコマンド
- 上位組織の承認を依頼する
- 条件付きで承認する
- リリースを承認する

#### 生成するイベント
- 施策が承認された
- 施策が条件付きで承認された
- 施策が却下された
- リリースが承認された

#### 保持する情報
- 承認ID
- 承認状態
- 承認条件
- 承認履歴
- 承認者情報

### 3. 法務確認集約

#### 概要
- 利用規約関連の確認プロセスを管理
- 法務部との連携を制御

#### 受け付けるコマンド
- 法務確認を依頼する
- 利用規約改定を依頼する

#### 生成するイベント
- 法務部へ相談された
- 利用規約の改定が必要と判断された
- 利用規約が改定された
- 会員から同意が得られた

#### 保持する情報
- 法務確認ID
- 確認状態
- 改定要否判断
- 改定内容
- 会員同意状況

### 4. 開発管理集約

#### 概要
- 開発プロセスを管理
- 品質保証部との連携を制御

#### 受け付けるコマンド
- 要件定義を依頼する
- 設計を開始する
- 実装を開始する
- 品質保証部レビューを依頼する

#### 生成するイベント
- 要件定義が完了した
- 設計が完了した
- 実装が完了した
- リリース判定が実施された

#### 保持する情報
- 開発ID
- 開発状態
- 品質メトリクス
- レビュー結果
- 成果物情報

### 5. 効果測定集約

#### 概要
- 施策の効果測定プロセスを管理
- 測定結果の分析を制御

#### 受け付けるコマンド
- 効果測定を開始する
- 効果測定結果を報告する

#### 生成するイベント
- 施策の効果が評価された
- フィードバックが完了した

#### 保持する情報
- 測定ID
- 測定項目
- 測定結果
- 分析結果
- フィードバック内容

## 集約間の関係
```mermaid
graph TB
    施策[施策パッケージ集約]
    承認[承認管理集約]
    法務[法務確認集約]
    開発[開発管理集約]
    効果[効果測定集約]

    施策 --> 承認: 承認依頼
    承認 --> 法務: 法務確認依頼
    承認 --> 開発: 開発開始
    開発 --> 承認: リリース判定
    承認 --> 効果: 効果測定開始
```

## 備考
- 集約は、関連する業務プロセスをカプセル化
- 各集約は独自のライフサイクルを持つ
- 集約間の関係は、イベントを通じて疎結合を維持
- 実際のイベントストーミングでは、集約は黄色の付箋紙で表現することが一般的
